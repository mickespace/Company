<!DOCTYPE html>

<head>
    <meta charset="utf-8" />
    <title>cjl</title>
    <script src="Mango.js"></script>
</head>

<body>
    <h1>HTML page ttttt</h1>
    <div>
        <button style="width: 100%; height: 60px" onclick="getCurrentProject()">获取当前项目信息11111</button>
    </div>
    <div>
        <button style="width: 100%; height: 60px" onclick="updateTitle()">更新页面标题222323</button>
    </div>
    <div>
        <button style="width: 100%; height: 60px" onclick="showWindow()">弹出窗体</button>
    </div>
    <div>
        <button style="width: 100%; height: 60px" onclick="showTip()">显示提示信息</button>
    </div>
    <div>
        <button style="width: 100%; height: 60px" onclick="invokeService()">调用服务</button>
    </div>
    <div>
        <button style="width: 100%; height: 60px" onclick="addWebMsgHandler()">监听网络消息</button>
    </div>
    <div>
        <button style="width: 100%; height: 60px" onclick="removeWebMsgHandler()">取消监听网络消息</button>
    </div>
    <br />
    <p id="res"></p>
    <script>
        function getCurrentProject() {
            var map = new Array('Name', 'Icon');
            mgContext.GetCurrentProject(map, function (r) {
                //alert(JSON.stringify(r));
                mgDialog.Alert("项目信息", JSON.stringify(r));
            });
        }

        var count = 0;

        function updateTitle() {
            mgPage.SetTitle('在JS中设置的标题' + count);
            count++;
        }

        function showWindow() {
            mgDialog.ShowDialog({
                Address: 'http://www.baidu.com',
                Title: 'JS中的标题',
                ShowOkButton: true
            }, function (t) {
                alert('用户单击了\'' + t + '\'按钮');
            });
        }

        function showTip() {
            var progress = 0;
            var sh = setInterval(function () {
                progress += 1;
                mgTip.Show("正在下载" + progress + "%...", progress);
                if (progress == 100) {
                    clearInterval(sh);
                }
            }, 100);
        }

        function invokeService() {
            mgNavi.Go("1.html");
            mgService.Invoke('Help', null, function (result) {
                if (!result.IsOk)
                    alert(result.Message);
            });
        }

        function addWebMsgHandler() {
            mgWeb.AddWebMsgHandler("fff", "notice/add", function (msg) {
                alert(JSON.stringify(msg));
            });
        }

        function removeWebMsgHandler() {
            mgWeb.RemoveWebMsgHandler('fff', "notice/add");
        }
    </script>
</body>